*org-roam.txt*             For NVIM v0.9.2            Last change: 2024 May 03

==============================================================================
Table of Contents                                 *org-roam-table-of-contents*

1. Getting Started                                  |org-roam-getting-started|
  - Installation                       |org-roam-getting-started-installation|
2. Configuration                                      |org-roam-configuration|
  - directory                               |org-roam-configuration-directory|
  - bindings                                 |org-roam-configuration-bindings|
  - database                                 |org-roam-configuration-database|
  - extensions                             |org-roam-configuration-extensions|
  - immediate                               |org-roam-configuration-immediate|
  - templates                               |org-roam-configuration-templates|
  - ui                                             |org-roam-configuration-ui|
3. Bindings                                                |org-roam-bindings|
  - Modifying bindings                  |org-roam-bindings-modifying-bindings|
  - Coming from Emacs                    |org-roam-bindings-coming-from-emacs|
4. Commands                                                |org-roam-commands|
  - RoamAddAlias                              |org-roam-commands-roamaddalias|
  - RoamAddOrigin                            |org-roam-commands-roamaddorigin|
  - RoamRemoveAlias                        |org-roam-commands-roamremovealias|
  - RoamRemoveOrigin                      |org-roam-commands-roamremoveorigin|
  - RoamReset                                    |org-roam-commands-roamreset|
  - RoamSave                                      |org-roam-commands-roamsave|
  - RoamUpdate                                  |org-roam-commands-roamupdate|
5. User Interface                                    |org-roam-user-interface|
  - Org Roam Buffer                  |org-roam-user-interface-org-roam-buffer|
6. API                                                          |org-roam-api|
  - Add Alias                                         |org-roam-api-add-alias|
  - Add Origin                                       |org-roam-api-add-origin|
  - Capture Node                                   |org-roam-api-capture-node|
  - Complete Node                                 |org-roam-api-complete-node|
  - Find Node                                         |org-roam-api-find-node|
  - Goto Next Node                               |org-roam-api-goto-next-node|
  - Goto Prev Node                               |org-roam-api-goto-prev-node|
  - Insert Node                                     |org-roam-api-insert-node|
  - Open Quickfix List                       |org-roam-api-open-quickfix-list|
  - Select Node                                     |org-roam-api-select-node|
  - Toggle Node Buffer                       |org-roam-api-toggle-node-buffer|
  - Remove Alias                                   |org-roam-api-remove-alias|
  - Remove Origin                                 |org-roam-api-remove-origin|
7. Database                                                |org-roam-database|
  - Files                                            |org-roam-database-files|
  - Files Path                                  |org-roam-database-files-path|
  - Files Sync                                  |org-roam-database-files-sync|
  - Find Nodes by Alias                |org-roam-database-find-nodes-by-alias|
  - Find Nodes by Alias Sync      |org-roam-database-find-nodes-by-alias-sync|
  - Find Nodes by File                  |org-roam-database-find-nodes-by-file|
  - Find Nodes by File Sync        |org-roam-database-find-nodes-by-file-sync|
  - Find Nodes by Tag                    |org-roam-database-find-nodes-by-tag|
  - Find Nodes by Tag Sync          |org-roam-database-find-nodes-by-tag-sync|
  - Find Nodes by Title                |org-roam-database-find-nodes-by-title|
  - Find Nodes by Title Sync      |org-roam-database-find-nodes-by-title-sync|
  - Get                                                |org-roam-database-get|
  - Get Sync                                      |org-roam-database-get-sync|
  - Get File Backlinks                  |org-roam-database-get-file-backlinks|
  - Get File Backlinks Sync        |org-roam-database-get-file-backlinks-sync|
  - Get File Links                          |org-roam-database-get-file-links|
  - Get File Links Sync                |org-roam-database-get-file-links-sync|
  - Load                                              |org-roam-database-load|
  - Load File                                    |org-roam-database-load-file|
  - Path                                              |org-roam-database-path|
  - Save                                              |org-roam-database-save|
8. Events                                                    |org-roam-events|
  - On Cursor Node Changed            |org-roam-events-on-cursor-node-changed|
9. Extensions                                            |org-roam-extensions|
  - Dailies                                      |org-roam-extensions-dailies|
  - Export                                        |org-roam-extensions-export|
  - Graph                                          |org-roam-extensions-graph|
  - Protocol                                    |org-roam-extensions-protocol|
10. Changelog                                             |org-roam-changelog|
11. Credits                                                 |org-roam-credits|

==============================================================================
1. Getting Started                                  *org-roam-getting-started*

Port of Org-roam <https://www.orgroam.com/> to neovim <https://neovim.io/>
using nvim-orgmode <https://github.com/nvim-orgmode/orgmode>.

Requires **neovim 0.9.2+**.


INSTALLATION                           *org-roam-getting-started-installation*

This plugin depends on nvim-orgmode/orgmode
<https://github.com/nvim-orgmode/orgmode> @ commit d4cc321
<https://github.com/nvim-orgmode/orgmode/commit/d4cc3210f235a845de8d372d02482163d31ded93>.


LAZY.NVIM ~

>lua
    {
      "chipsenkbeil/org-roam.nvim",
      dependencies = { 
        { 
          "nvim-orgmode/orgmode", 
          commit = "d4cc3210f235a845de8d372d02482163d31ded93",
        },
      },
      config = function()
        require("org-roam").setup({
          directory = "~/orgfiles",
        })
      end
    }
<


PACKER.NVIM ~

>lua
    use {
      "chipsenkbeil/org-roam.nvim",
      requires = { 
        { 
          "nvim-orgmode/orgmode",
          commit = "d4cc3210f235a845de8d372d02482163d31ded93",
        },
      },
      config = function()
        require("org-roam").setup({
          directory = "~/orgfiles",
        })
      end
    }
<


==============================================================================
2. Configuration                                      *org-roam-configuration*


DIRECTORY                                   *org-roam-configuration-directory*

Path to the directory containing org files for use with org-roam.

Takes a string representing the path to the directory, which can can contain
`~` that will expand to your home directory.

>lua
    require("org-roam").setup({
      directory = "~/orgfiles",
    })
<


BINDINGS                                     *org-roam-configuration-bindings*

Configuration settings used to specify keybindings.


ADD ALIAS ~

Adds an alias to the node under cursor.

Takes a string representing the keybinding. Defaults to `<Leader>naa`.

>lua
    require("org-roam").setup({
      bindings = {
        add_alias = "<LocalLeader>naa",
      },
    })
<


ADD ORIGIN ~

Adds an origin to the node under cursor.

Takes a string representing the keybinding. Defaults to `<Leader>noa`.

>lua
    require("org-roam").setup({
      bindings = {
        add_origin = "<LocalLeader>noa",
      },
    })
<


CAPTURE ~

Opens a roam capture window.

Takes a string representing the keybinding. Defaults to `<Leader>nc`.

>lua
    require("org-roam").setup({
      bindings = {
        capture = "<LocalLeader>nc",
      },
    })
<


COMPLETE AT POINT ~

Completes the node under cursor by searching for a node with matching title or
alias. If exactly one match is found, the text under cursor is replaced with
the link; otherwise, a selection dialog pops up to pick the node.

Takes a string representing the keybinding. Defaults to `<Leader>n.`.

>lua
    require("org-roam").setup({
      bindings = {
        complete_at_point = "<LocalLeader>n.",
      },
    })
<


FIND NODE ~

Finds a node by title or alias and opens it in the current window.

If the node does not exist, opens a capture buffer for the new node using the
title.

Takes a string representing the keybinding. Defaults to `<Leader>nf`.

>lua
    require("org-roam").setup({
      bindings = {
        find_node = "<LocalLeader>nf",
      },
    })
<


GOTO NEXT NODE ~

Goes to the next node sequentially based on origin of the node under cursor.

If more than one node has the node under cursor as its origin, a selection
dialog is displayed to choose the node.

Takes a string representing the keybinding. Defaults to `<Leader>nn`.

>lua
    require("org-roam").setup({
      bindings = {
        goto_next_node = "<LocalLeader>nn",
      },
    })
<


GOTO PREV NODE ~

Goes to the previous node sequentially based on origin of the node under
cursor.

Takes a string representing the keybinding. Defaults to `<Leader>np`.

>lua
    require("org-roam").setup({
      bindings = {
        goto_prev_node = "<LocalLeader>np",
      },
    })
<


INSERT NODE ~

Inserts a link at cursor position to a node by title or alias.

If the node does not exist, opens a capture buffer for the new node using the
title.

Takes a string representing the keybinding. Defaults to `<Leader>ni`.

>lua
    require("org-roam").setup({
      bindings = {
        insert_node = "<LocalLeader>ni",
      },
    })
<


INSERT NODE IMMEDIATE ~

Inserts a link at cursor position to a node by title or alias. Unlike
`insert_node`, this does not open a capture buffer if a new node is created.

Takes a string representing the keybinding. Defaults to `<Leader>nm`.

>lua
    require("org-roam").setup({
      bindings = {
        insert_node_immediate = "<LocalLeader>nm",
      },
    })
<


QUICKFIX BACKLINKS ~

Opens the quickfix list, populating it with backlinks for the node under
cursor.

Takes a string representing the keybinding. Defaults to `<Leader>nq`.

>lua
    require("org-roam").setup({
      bindings = {
        quickfix_backlinks = "<LocalLeader>nq",
      },
    })
<


REMOVE ALIAS ~

Removes an alias from the node under cursor.

Takes a string representing the keybinding. Defaults to `<Leader>nar`.

>lua
    require("org-roam").setup({
      bindings = {
        remove_alias = "<LocalLeader>nar",
      },
    })
<


REMOVE ORIGIN ~

Removes the origin from the node under cursor.

Takes a string representing the keybinding. Defaults to `<Leader>nor`.

>lua
    require("org-roam").setup({
      bindings = {
        remove_origin = "<LocalLeader>nor",
      },
    })
<


TOGGLE ROAM BUFFER ~

Opens the roam buffer for the node under cursor, updating the buffer when the
cursor moves to a different node. See the user interface
|org-roam-org-roam-buffer| section for details.

Takes a string representing the keybinding. Defaults to `<Leader>nl`.

>lua
    require("org-roam").setup({
      bindings = {
        toggle_roam_buffer = "<LocalLeader>nl",
      },
    })
<


TOGGLE ROAM BUFFER FIXED ~

Opens the roam buffer for a specific node, and will not change as the cursor
moves across nodes. See the user interface |org-roam-org-roam-buffer| section
for details.

Takes a string representing the keybinding. Defaults to `<Leader>nb`.

>lua
    require("org-roam").setup({
      bindings = {
        toggle_roam_buffer_fixed = "<LocalLeader>nb",
      },
    })
<


DATABASE                                     *org-roam-configuration-database*

Configuration settings tied to the roam database.


PATH ~

Sets the path where the roam database will be stored & loaded when persisting
to disk.

Takes a string representing the path. Defaults to For example,
`~/.local/share/nvim/org-roam.nvim/db`.

>lua
    require("org-roam").setup({
      database = {
        path = "~/some/path/to/db",
      },
    })
<


PERSIST ~

If true, the database will be written to disk to save on future loading times;
otherwise, whenever neovim boots the entire database will need to be rebuilt.

Takes a boolean. Defaults to `true`.

>lua
    require("org-roam").setup({
      database = {
        persist = false,
      },
    })
<


UPDATE ON SAVE ~

If true, updates database whenever a write occurs. If you have large files, it
is recommended to disable this option and manually update using the vim command
`RoamUpdate`.

Takes a boolean. Defaults to `true`.

>lua
    require("org-roam").setup({
      database = {
        update_on_save = false,
      },
    })
<


EXTENSIONS                                 *org-roam-configuration-extensions*

Configuration settings tied to roam extensions.


DAILIES ~

Configuration settings tied to the roam dailies extension.

1. directory

Path to the directory containing daily org-roam files.

Takes a string representing the path to the directory. Defaults to `daily`.

>lua
    require("org-roam").setup({
      extensions = {
        dailies = {
          directory = "journal",
        },
      },
    })
<


2. templates

A map of templates associated with roam. These have the exact same format as
`nvim-orgmode`'s templates, but include additional variables and are only
displayed and used during roam's capture dialog.

Note that the target must be provided and must contain a date in the form of
`YYYY-MM-DD`. See |org-roam-templates| for more details.

Takes a `table<string, table>`. Defaults to the following:

>lua
    require("org-roam").setup({
      extensions = {
        dailies = {
          templates = {
            d = {
              description = "default",
              template = "%?",
              target = "%<%Y-%m-%d>.org",
            },
          },
        },
      },
    })
<




IMMEDIATE                                   *org-roam-configuration-immediate*

Configuration settings tied to immediate mode.


TARGET ~

Target where the immediate-mode node should be written.

Takes a string. Defaults to `%<%Y%m%d%H%M%S>-%[slug].org`.

>lua
    require("org-roam").setup({
      immediate = {
        target = "%[slug].org",
      },
    })
<


TEMPLATE ~

Template to use for the immediate-mode node's content.

Takes a string. Defaults to ==.

>lua
    require("org-roam").setup({
      immediate = {
        template = "The date is %<%Y%m%d>!",
      },
    })
<


TEMPLATES                                   *org-roam-configuration-templates*

A map of templates associated with roam. These have the exact same format as
`nvim-orgmode`'s templates, but include additional variables and are only
displayed and used during roam's capture dialog.

Takes a `table<string, table>`. Defaults to the following:

>lua
    require("org-roam").setup({
      templates = {
        d = {
          description = "default",
          template = "%?",
          target = "%<%Y%m%d%H%M%S>-%[slug].org",
        },
      },
    })
<

Variables:

- `%r`: Prints the roam directory.
- `%R`: Like `%r`, but inserts the full path.

Target-only Variables:

- `%[sep]`: Prints the path separator for the current operating system.
- `%[slug]`: Prints a slug representing the node's title.
- `%[title]`: Prints the node's title.


UI                                                 *org-roam-configuration-ui*

Configuration settings tied to the user interface.


NODE VIEW ~

Bindings tied specifically to the roam buffer.

1. focus on toggle

If true, switches focus to the node buffer when opened.

Takes a boolean. Defaults to `true`.

>lua
    require("org-roam").setup({
      ui = {
        node_buffer = {
          focus_on_toggle = false,
        },
      },
    })
<


2. highlight previews

If true, previews will be highlighted as org syntax when expanded.

NOTE: This can cause flickering on initial expansion, but preview highlights
are then cached for future renderings. If flickering is undesired, disable
highlight previews.

Takes a boolean. Defaults to `true`.

>lua
    require("org-roam").setup({
      ui = {
        node_buffer = {
          highlight_previews = false,
        },
      },
    })
<


3. open

Configuration to open the node view window.

Takes a string or a function that returns a window handle. Defaults to
`botright vsplit | vertical resize 50`.

>lua
    require("org-roam").setup({
      ui = {
        node_buffer = {
          open = function()
            return vim.api.nvim_open_win(0, false, {
              relative = "editor",
              row = 0,
              col = 0,
              width = 50,
              height = 20,
            })
          end,
        },
      },
    })
<


4. show keybindings

If true, will include a section covering available keybindings.

Takes a boolean. Defaults to `true`.

>lua
    require("org-roam").setup({
      ui = {
        node_buffer = {
          show_keybindings = false,
        },
      },
    })
<


5. unique

If true, shows a single link (backlink/citation/unlinked reference) per node
instead of all links.

Takes a boolean. Defaults to `false`.

>lua
    require("org-roam").setup({
      ui = {
        node_buffer = {
          unique = true,
        },
      },
    })
<




==============================================================================
3. Bindings                                                *org-roam-bindings*

  Name                       Keybinding    Description
  -------------------------- ------------- ---------------------------------------------------------------------------
  add_(alias)                <Leader>naa   Adds an alias to the node under cursor.
  add_(origin)               <Leader>noa   Adds an origin to the node under cursor.
  capture                    <Leader>nc    Opens org-roam capture window.
  complete_(atpoint)         <Leader>n.    Completes the node under cursor.
  find_(node)                <Leader>nf    Finds node and moves to it, creating it if it does not exist.
  goto_(nextnode)            <Leader>nn    Goes to the next node in sequence (via origin) for the node under cursor.
  goto_(prevnode)            <Leader>np    Goes to the prev node in sequence (via origin) for the node under cursor.
  insert_(node)              <Leader>ni    Inserts node at cursor position, creating it if it does not exist.
  insert_(nodeimmediate)     <Leader>nm    Same as insert_node, but skips opening capture buffer.
  quickfix_(backlinks)       <Leader>nq    Opens the quickfix menu for backlinks to the current node under cursor.
  remove_(alias)             <Leader>nar   Removes an alias from the node under cursor.
  remove_(origin)            <Leader>nor   Removes the origin from the node under cursor.
  toggle_(roambuffer)        <Leader>nl    Toggles the org-roam node-view buffer for the node under cursor.
  toggle_(roambufferfixed)   <Leader>nb    Toggles a fixed org-roam node-view buffer for a selected node.

MODIFYING BINDINGS                      *org-roam-bindings-modifying-bindings*

Bindings can be changed during configuration by overwriting them within the
`bindings` table:

>lua
    require("org-roam").setup({
      -- ...
      bindings = {
        capture = "<LocalLeader>nc",
      },
    })
<

To disable all bindings, set the `bindings` field to `false`:

>lua
    require("org-roam").setup({
      -- ...
      bindings = false,
    })
<


COMING FROM EMACS                        *org-roam-bindings-coming-from-emacs*

Want to have bindings similar to Emacs's Org Roam <https://www.orgroam.com/>?
Here is a recommended setup you can use to leverage `C-c`

>lua
    require("org-roam").setup({
      bindings = {
        add_alias                = "<C-c>naa",
        add_origin               = "<C-c>noa",
        capture                  = "<C-c>nc",
        complete_at_point        = "<M-/>",
        find_node                = "<C-c>nf",
        goto_next_node           = "<C-c>nn",
        goto_prev_node           = "<C-c>np",
        insert_node              = "<C-c>ni",
        insert_node_immediate    = "<C-c>nm",
        quickfix_backlinks       = "<C-c>nq",
        remove_alias             = "<C-c>nar",
        remove_origin            = "<C-c>nor",
        toggle_roam_buffer       = "<C-c>nl",
        toggle_roam_buffer_fixed = "<C-c>nb",
      },
    })
<

Keep in mind that nvim-orgmode <https://github.com/nvim-orgmode/orgmode> maps
`C-c` to closing a capture window, so you'll want to rebind it:

>lua
    -- Override `org_capture_finalize` mapping to make org-roam mappings work in capture window
    require("orgmode").setup({
      mappings = {
        capture = {
          -- Behave like Emacs' orgmode capture
          org_capture_finalize = "<C-c><C-c>",
        }
      }
    })
<


==============================================================================
4. Commands                                                *org-roam-commands*


ROAMADDALIAS                                  *org-roam-commands-roamaddalias*

:RoamAddAlias [<ARGS>]

Description:

Adds an alias to the node under the cursor.

If arguments are supplied, they are used as the alias; otherwise, a prompt is
provided to specify the alias.


ROAMADDORIGIN                                *org-roam-commands-roamaddorigin*

:RoamAddOrigin [<ARGS>]

Description:

Adds/replaces the origin to the node under the cursor. Opens a selection dialog
to pick the node to act as the origin.

If arguments are supplied, they are used as the initial input to the selection
dialog.


ROAMREMOVEALIAS                            *org-roam-commands-roamremovealias*

:RoamRemoveAlias [<ARGS>]

Description:

Removes an alias for the node under the cursor. Opens a selection dialog to
pick the alias to remove.

If arguments are supplied, they are used as the initial input to the selection
dialog.


ROAMREMOVEORIGIN                          *org-roam-commands-roamremoveorigin*

:RoamRemoveOrigin [<ARGS>]

Description:

Removes the origin for the node under the cursor.


ROAMRESET                                        *org-roam-commands-roamreset*

:RoamReset [sync]

Description:

Resets the roam database, wiping and rebuilding it.

If `sync` argument is provided, will perform the reset synchronously.


ROAMSAVE                                          *org-roam-commands-roamsave*

:RoamSave[!] [sync]

Description:

Save the roam database to disk. If no changes to the database have occurred
since last save, nothing happens.

If `!` is provided, will force saving.

If `sync` argument is provided, will perform the save synchronously.


ROAMUPDATE                                      *org-roam-commands-roamupdate*

:RoamUpdate[!] [sync]

Description:

Updates the roam database, checking every existing file for changes.

If `!` is provided, will perform a complete recheck of the database for changes
found on disk including new and deleted files.

If `sync` argument is provided, will perform the update synchronously.


==============================================================================
5. User Interface                                    *org-roam-user-interface*


ORG ROAM BUFFER                      *org-roam-user-interface-org-roam-buffer*

When within the org-roam buffer, you can navigate around like normal with a
couple of specific bindings available:

- Press `<Enter>` on a link to navigate to it in another window.
- Press `<Tab>` to expand or collapse a preview of the content of a
    backlink, reference link, or unlinked reference.
- Press `<STab>` to expand or collapse all previews.
- Press `<C-r>` to refresh the buffer. This can be handy if some
    information has changed in the database.


==============================================================================
6. API                                                          *org-roam-api*


ADD ALIAS                                             *org-roam-api-add-alias*

roam.api.add_alias({opts})

Description:

Adds an alias to the node under cursor.

Parameters:

- {opts} optional table.
    - alias: optional, if provided, added to the node under cursor, otherwise
        prompts for an alias to add to the node under cursor.

Example:

>lua
    local roam = require("org-roam")
    roam.api.add_alias({ alias = "My Alias" })
<


ADD ORIGIN                                           *org-roam-api-add-origin*

roam.api.add_origin({opts})

Description:

Adds an origin to the node under cursor. Will replace the existing origin.

If no `origin` is specified, a prompt is provided.

Parameters:

- {opts} optional table.
    - origin: optional, if provided, added to the node under cursor, otherwise
        prompts for an origin to add to the node under cursor.

Returns:

A promise of a boolean, which is true if the origin added, otherwise false.

Example:

>lua
    local roam = require("org-roam")
    roam.api.add_origin({ origin = "1234" }):next(function(success)
      if success then
        print("Added origin")
      end
    end)
<


CAPTURE NODE                                       *org-roam-api-capture-node*

roam.api.capture_node({opts})

Description:

Creates a node if it does not exist, prompting for a template to use, and
restores the current window configuration upon completion.

If `templates` is provided, will be used instead of `roam.config.templates`.

Parameters:

- {opts} optional table.
    - immediate: optional, if true, skips displaying the capture buffer and
        instead populates a file using the immediate configuration.
        If title is also provided, it is used as the title of the
        created node.
    - origin: optional, id of node acting as origin of this node.
    - templates: optional, dictionary of key -> opts where key is a string of
        exactly one character and opts is the orgmode template. Note
        that the target MUST be specified for each template!
    - title: optional, seeds the capture dialog with the title string.

Returns:

A promise of either the id of the captured node, or nil if capture canceled.

Example:

>lua
    local roam = require("org-roam")
    roam.api.capture_node({
      templates = {
        c = {
          description = "custom",
          template = "%?",
          target = "custom-%<%Y%m%d>.org",
        },
      },
    }):next(function(id)
      if id then
        print("Captured node: " .. id)
      else
        print("Capture canceled")
      end
    end)
<


COMPLETE NODE                                     *org-roam-api-complete-node*

roam.api.complete_node({opts})

Description:

Opens a dialog to select a node based on the expression under the cursor and
replace the expression with a link to the selected node. If there is only one
choice, this will automatically inject the link without bringing up the
selection dialog.

This implements the functionality of both `org-roam-complete-link-at-point` and
`org-roam-complete-everywhere`.

Parameters:

- {opts} optional table.
    - win: optional, id of window where the node link will be completed (default = 0).

Returns:

A promise of a boolean, which is true if the node was completed, otherwise
false.

Example:

>lua
    local roam = require("org-roam")
    roam.api.complete_node({ win = 123 }):next(function(success)
      if success then
        print("Completed node")
      end
    end)
<


FIND NODE                                             *org-roam-api-find-node*

roam.api.find_node({opts})

Description:

Creates a node if it does not exist, and then visits the node in the current
window.

If `templates` is provided, will be used instead of `roam.config.templates`
when capturing a new node for visiting.

Parameters:

- {opts} optional table.
    - origin: optional, id of node acting as origin of this node (creation-only).
    - templates: optional, dictionary of key -> opts where key is a string of
        exactly one character and opts is the orgmode template. Note
        that the target MUST be specified for each template!
    - title: optional, seeds the select dialog with the title string.

Returns:

A promise of either the id of the found node, or nil if canceled.

Example:

>lua
    local roam = require("org-roam")
    roam.api.find_node({ title = "Some Node" }):next(function(id)
      if id then
        print("Found " .. id)
      end
    end)
<


GOTO NEXT NODE                                   *org-roam-api-goto-next-node*

roam.api.goto_nextnode({opts})

Description:

Goes to the next node in sequence for the node under cursor.

Leverages a lookup of nodes whose origin match the node under cursor.

Parameters:

- {opts} optional table.
    - win: optional, id of window where buffer will be loaded (default = 0).

Returns:

A promise of the id of the next node, otherwise nil.

Example:

>lua
    local roam = require("org-roam")
    roam.api.goto_next_node({ win = 123 }):next(function(id)
      if id then
        print("Navigated to next node " .. id)
      end
    end)
<


GOTO PREV NODE                                   *org-roam-api-goto-prev-node*

roam.api.goto_prevnode({opts})

Description:

Goes to the previous node in sequence for the node under cursor.

Leverages a lookup of the node using the origin of the node under cursor.

Parameters:

- {opts} optional table.
    - win: optional, id of window where buffer will be loaded (default = 0).

Returns:

A promise of the id of the previous node, otherwise nil.

Example:

>lua
    local roam = require("org-roam")
    roam.api.goto_prev_node({ win = 123 }):next(function(id)
      if id then
        print("Navigated to previous node " .. id)
      end
    end)
<


INSERT NODE                                         *org-roam-api-insert-node*

roam.api.insert_node({opts})

Description:

Creates a node if it does not exist, and inserts a link to the node at the
current cursor location.

If `immediate` is true, no template will be used to create a node and instead
the node will be created with the minimum information and the link injected
without navigating to another buffer.

If `templates` is provided, will be used instead of `roam.config.templates`
when capturing a new node for insertion.

If `ranges` is provided, will replace the given ranges within the buffer versus
inserting at point, where everything uses 1-based indexing and inclusive.

Parameters:

- {opts} optional table.
    - immediate: optional, if true, skips displaying the capture buffer and
        instead populates a file using the immediate configuration.
        If title is also provided, it is used as the title of the
        created node.
    - origin: optional, id of node acting as origin of this node (creation-only).
    - templates: optional, dictionary of key -> opts where key is a string of
        exactly one character and opts is the orgmode template. Note
        that the target MUST be specified for each template!
    - title: optional, seeds the select dialog with the title string.
    - ranges: optional, list of ranges to replace. Each range is comprised of
        the following fields:
        - start_row: integer (one-indexed, inclusive)
        - start_col: integer (one-indexed, inclusive)
        - end_row: integer (one-indexed, inclusive)
        - end_col: integer (one-indexed, inclusive)

Returns:

A promise of the id of the inserted node, or nil if canceled.

Example:

>lua
    local roam = require("org-roam")
    roam.api.insert_node({ 
      title = "Some Node",
      ranges = { { start_row = 1, end_row = 3, start_col = 5, end_col = 12 } },
    }):next(function(id)
      if id then
        print("Inserted node " .. id)
      end
    end)
<


OPEN QUICKFIX LIST                           *org-roam-api-open-quickfix-list*

roam.ui.open_quickfixlist({opts})

Description:

Creates and opens a new quickfix list, populated with various links tied to a
roam node.

Parameters:

- {opts} optional table.
    - id: optional, string id of the node whose information will populate
        the list. If not provided, will open a selection dialog to pick
        a node.
    - backlinks: optional, if true, show's the selected node's backlinks.
    - links: optional, if true, show's the selected node's links.
    - show_preview: optional, if true, loads a preview of content for each
        list item.

Returns:

A promise of a boolean, which is true if the quickfix list is opened for a
node, otherwise false (e.g. when no node under cursor).

Example:

>lua
    local roam = require("org-roam")
    roam.ui.open_quickfix_list({ id = "1234", backlinks = true }):next(function(success)
      if success then
        print("Opened quickfix list")
      end
    end)
<


SELECT NODE                                         *org-roam-api-select-node*

roam.ui.select_node({opts})

Description:

Builds a selection dialog populated by nodes, displaying their titles and
aliases as choices in the selection. Returns a builder interface.

Parameters:

- {opts} optional table.
    - allow_selectmissing: optional, if true, the user can press `<Enter>`
        when no choices are available to select the
        input instead. Additionally, a user can press
        `<S-Enter>` at any time in the selection dialog
        to select the input, regardless of choices shown.
    - auto_select: optional, if true and init_input is not empty, will
        automatically pick the choice if there is exactly
        one match.
    - exclude: optional, list of ids of nodes to exclude from choices.
    - include: optional, list of ids of nodes to include in the choices. If
        not provided, all nodes will immediately be available.
    - init_input: optional, string representing initial input to provide to
        the selection dialog, as if the user typed it.

Returns:

A builder interface for the selection dialog, which contains a handful of
methods that can be used to register callbacks and open the dialog.

- {on_choice} takes a single function, which will be passed the selection
    as an argument. The selection is a table containing an `id` and `label`
    representing the id of the selected node and the title or alias of the
    choice that was picked. This function is only called when a regular
    selection is made, not when input selected. Returns the builder.
- {on_choicemissing} takes a single function, which will be passed the
    text of the input as an argument. This function is only called when
    `allow_select_missing` is true and the input is selected instead of
    a valid choice. Returns the builder.
- {on_cancel} takes a single function, which is invoked when the selection
    dialog is closed without making any choice. Returns the builder.
- {open} will open the selection dialog, and returns the window handle.

Example:

>lua
    local roam = require("org-roam")
    local win = roam.ui.select_node({ init_input = "trees" })
        :on_choice(function(selection)
            print("picked " .. selection.id)
        end)
        :on_choice_missing(function(text)
            print("picked " .. text)
        end)
        :on_cancel(function()
            print("canceled")
        end)
        :open()
<


TOGGLE NODE BUFFER                           *org-roam-api-toggle-node-buffer*

roam.ui.toggle_nodebuffer({opts})

Description:

Toggles an org-roam buffer, either for a cursor or for a fixed id.

If `fixed` is true or an string, will load a fixed buffer, otherwise the buffer
will change based on the node under cursor.

If `focus` is true, will switch the current window to the node buffer's window.

Parameters:

- {opts} optional table.
    - fixed: optional, indicates that the node buffer should not update when
        the node changes under the cursor. Takes the id of a node or
        a boolean value, which if true will leverage the select dialog
        to pick a node.
    - focus: optional, if true, switches the current window to the newly-created
        window that contains the node buffer.

Returns:

A promise of the handle of the created window, or nil if window closed.

Example:

>lua
    local roam = require("org-roam")
    roam.ui.open_node_buffer({ fixed = "1234", focus = true }):next(function(win)
      if win then
        print("Opened node buffer in window " .. win)
      end
    end)
<


REMOVE ALIAS                                       *org-roam-api-remove-alias*

roam.api.remove_alias({opts})

Description:

Removes an alias from the node under cursor.

Parameters:

- {opts} optional table.
    - alias: optional, if provided, removes from node under cursor, otherwise
        prompts for an alias to remove from the node under cursor.
    - all: optional, if true, will remove all aliases instead of just one.
        Overrides removing `alias` from node under cursor.

Returns:

A promise of a boolean, which is true if the alias was removed, otherwise
false.

Example:

>lua
    local roam = require("org-roam")
    roam.api.remove_alias({ all = true }):next(function(success)
      if success then
        print("Removed alias")
      end
    end)
<


REMOVE ORIGIN                                     *org-roam-api-remove-origin*

roam.api.remove_origin()

Description:

Removes the origin from the node under cursor.

Returns:

A promise of a boolean, which is true if the origin was removed, otherwise
false.

Example:

>lua
    local roam = require("org-roam")
    roam.api.remove_origin():next(function(success)
      if success then
        print("Removed origin")
      end
    end)
<


==============================================================================
7. Database                                                *org-roam-database*


FILES                                                *org-roam-database-files*

roam.database:files({opts})

Description:

Loads org files (or retrieves from cache) asynchronously.

Parameters:

- {opts} optional table.
    - force: optional, if true, will reload each file regardless of
        whether they have changed on disk. If false, only reloads
        pre-existing files if they have changed.
    - skip: optional, if true, will avoid loading entirely and just
        return the files as they are (no updates).

Example:

>lua
    local roam = require("org-roam")
    roam.database:files():next(function(files)
      for _, path in ipairs(files.paths) do
        print("File " .. path)
      end
    end)
<


FILES PATH                                      *org-roam-database-files-path*

roam.database:files_path()

Description:

Returns the path to the files directory.

Example:

>lua
    local roam = require("org-roam")
    roam.database:files_path()
<


FILES SYNC                                      *org-roam-database-files-sync*

roam.database:files_sync({opts})

Description:

Loads org files (or retrieves from cache) synchronously.

Parameters:

- {opts} optional table.
    - force: optional, if true, will reload each file regardless of
        whether they have changed on disk. If false, only reloads
        pre-existing files if they have changed.
    - timeout: optional, integer representing maximum time (in milliseconds)
        to wait for the operation to complete. Throws error on timeout.
    - skip: optional, if true, will avoid loading entirely and just
        return the files as they are (no updates).

Example:

>lua
    local roam = require("org-roam")
    local files = roam.database:files_sync()
    for _, path in ipairs(files.paths) do
      print("File " .. path)
    end
<


FIND NODES BY ALIAS                    *org-roam-database-find-nodes-by-alias*

roam.database:find_nodesbyalias({alias})

Description:

Retrieves nodes with the specified alias from the database.

Operation is performed asynchronously, returning a promise of a list of nodes
that have the alias.

Parameters:

- {alias} string representing the node's alias.

Example:

>lua
    local roam = require("org-roam")
    roam.database:find_nodes_by_alias("Some Alias"):next(function(nodes)
      for _, node in ipairs(nodes) do
        print("Got node " .. node.id)
      end
    end)
<


FIND NODES BY ALIAS SYNC          *org-roam-database-find-nodes-by-alias-sync*

roam.database:find_nodesbyaliassync({alias}, {opts})

Description:

Retrieves nodes with the specified alias from the database. Operation is
performed synchronously, returning a list of nodes.

Parameters:

- {alias} string representing the node's alias.
- {opts} optional table.
    - timeout: optional, integer representing maximum time (in milliseconds)
        to wait for the operation to complete. Throws error on timeout.

Example:

>lua
    local roam = require("org-roam")
    local nodes = roam.database:find_nodes_by_alias_sync("Some Alias")
    for _, node in ipairs(nodes) do
      print("Got node " .. node.id)
    end
<


FIND NODES BY FILE                      *org-roam-database-find-nodes-by-file*

roam.database:find_nodesbyfile({file})

Description:

Retrieves nodes with the specified file from the database.

Operation is performed asynchronously, returning a promise of a list of nodes
that have the file.

Parameters:

- {file} string representing the node's file path.

Example:

>lua
    local roam = require("org-roam")
    roam.database:find_nodes_by_file("path/to/file.org"):next(function(nodes)
      for _, node in ipairs(nodes) do
        print("Got node " .. node.id)
      end
    end)
<


FIND NODES BY FILE SYNC            *org-roam-database-find-nodes-by-file-sync*

roam.database:find_nodesbyfilesync({file}, {opts})

Description:

Retrieves nodes with the specified file from the database. Operation is
performed synchronously, returning a list of nodes.

Parameters:

- {file} string representing the node's file path.
- {opts} optional table.
    - timeout: optional, integer representing maximum time (in milliseconds)
        to wait for the operation to complete. Throws error on timeout.

Example:

>lua
    local roam = require("org-roam")
    local nodes = roam.database:find_nodes_by_file_sync("path/to/file.org")
    for _, node in ipairs(nodes) do
      print("Got node " .. node.id)
    end
<


FIND NODES BY TAG                        *org-roam-database-find-nodes-by-tag*

roam.database:find_nodesbytag({tag})

Description:

Retrieves nodes with the specified tag from the database.

Operation is performed asynchronously, returning a promise of a list of nodes
that have the tag.

Parameters:

- {tag} string representing the tag.

Example:

>lua
    local roam = require("org-roam")
    roam.database:find_nodes_by_tag("example"):next(function(nodes)
      for _, node in ipairs(nodes) do
        print("Got node " .. node.id)
      end
    end)
<


FIND NODES BY TAG SYNC              *org-roam-database-find-nodes-by-tag-sync*

roam.database:find_nodesbytagsync({tag}, {opts})

Description:

Retrieves nodes with the specified tag from the database. Operation is
performed synchronously, returning a list of nodes.

Parameters:

- {tag} string representing the tag.
- {opts} optional table.
    - timeout: optional, integer representing maximum time (in milliseconds)
        to wait for the operation to complete. Throws error on timeout.

Example:

>lua
    local roam = require("org-roam")
    local nodes = roam.database:find_nodes_by_tag_sync("example")
    for _, node in ipairs(nodes) do
      print("Got node " .. node.id)
    end
<


FIND NODES BY TITLE                    *org-roam-database-find-nodes-by-title*

roam.database:find_nodesbytitle({title})

Description:

Retrieves nodes with the specified title from the database.

Operation is performed asynchronously, returning a promise of a list of nodes
that have the title.

Parameters:

- {title} string representing the node's title.

Example:

>lua
    local roam = require("org-roam")
    roam.database:find_nodes_by_title("Some Title"):next(function(nodes)
      for _, node in ipairs(nodes) do
        print("Got node " .. node.id)
      end
    end)
<


FIND NODES BY TITLE SYNC          *org-roam-database-find-nodes-by-title-sync*

roam.database:find_nodesbytitlesync({title}, {opts})

Description:

Retrieves nodes with the specified title from the database. Operation is
performed synchronously, returning a list of nodes.

Parameters:

- {title} string representing the node's title.
- {opts} optional table.
    - timeout: optional, integer representing maximum time (in milliseconds)
        to wait for the operation to complete. Throws error on timeout.

Example:

>lua
    local roam = require("org-roam")
    local nodes = roam.database:find_nodes_by_title_sync("example")
    for _, node in ipairs(nodes) do
      print("Got node " .. node.id)
    end
<


GET                                                    *org-roam-database-get*

roam.database:get({id})

Description:

Retrieves a node from the database by its id. Operation is performed
asynchronously, returning a promise of the node or nil if none exists.

Parameters:

- {id} string representing the node's id.

Example:

>lua
    local roam = require("org-roam")
    roam.database:get("1234"):next(function(node)
      if node then
        print("Got node " .. node.title)
      end
    end)
<


GET SYNC                                          *org-roam-database-get-sync*

roam.database:get_sync({id}, {opts})

Description:

Retrieves a node from the database by its id. Operation is performed
synchronously, returning the node or nil if none exists.

Parameters:

- {id} string representing the node's id.
- {opts} optional table.
    - timeout: optional, integer representing maximum time (in milliseconds)
        to wait for the operation to complete. Throws error on timeout.

Example:

>lua
    local roam = require("org-roam")
    local node = roam.database:get_sync("1234")
    if node then
      print("Got node " .. node.title)
    end
<


GET FILE BACKLINKS                      *org-roam-database-get-file-backlinks*

roam.database:get_filebacklinks({file}, {opts})

Description:

Retrieves ids of nodes linking to a file. Operation is performed
asynchronously, returning a promise of a table of id -> distance away from the
file.

Parameters:

- {file} string representing a file path.
- {opts} optional table.
    - max_depth: optional, integer representing maximum depth to traverse
        from the nodes of the file (default 1).

Example:

>lua
    local roam = require("org-roam")
    roam.database:get_file_backlinks("path/to/file.org"):next(function(backlinks)
      for id, distance in pairs(backlinks) do
        print("Got node " .. id .. " with distance " .. distance)
      end
    end)
<


GET FILE BACKLINKS SYNC            *org-roam-database-get-file-backlinks-sync*

roam.database:get_filebacklinkssync({id}, {opts})

Description:

Retrieves ids of nodes linking to a file. Operation is performed synchronously,
returning a table of id -> distance away from the file.

Parameters:

- {file} string representing a file path.
- {opts} optional table.
    - max_depth: optional, integer representing maximum depth to traverse
        from the nodes of the file (default 1).
    - timeout: optional, integer representing maximum time (in milliseconds)
        to wait for the operation to complete. Throws error on timeout.

Example:

>lua
    local roam = require("org-roam")
    local backlinks = roam.database:get_file_backlinks_sync("path/to/file.org")
    for id, distance in pairs(backlinks) do
      print("Got node " .. id .. " with distance " .. distance)
    end
<


GET FILE LINKS                              *org-roam-database-get-file-links*

roam.database:get_filelinks({file}, {opts})

Description:

Retrieves ids of nodes linked from a file. Operation is performed
asynchronously, returning a promise of a table of id -> distance away from the
file.

Parameters:

- {file} string representing a file path.
- {opts} optional table.
    - max_depth: optional, integer representing maximum depth to traverse
        from the nodes of the file (default 1).

Example:

>lua
    local roam = require("org-roam")
    roam.database:get_file_links("path/to/file.org"):next(function(links)
      for id, distance in pairs(links) do
        print("Got node " .. id .. " with distance " .. distance)
      end
    end)
<


GET FILE LINKS SYNC                    *org-roam-database-get-file-links-sync*

roam.database:get_filelinkssync({id}, {opts})

Description:

Retrieves ids of nodes linked from a file. Operation is performed
synchronously, returning a table of id -> distance away from the file.

Parameters:

- {file} string representing a file path.
- {opts} optional table.
    - max_depth: optional, integer representing maximum depth to traverse
        from the nodes of the file (default 1).
    - timeout: optional, integer representing maximum time (in milliseconds)
        to wait for the operation to complete. Throws error on timeout.

Example:

>lua
    local roam = require("org-roam")
    local links = roam.database:get_file_links_sync("path/to/file.org")
    for id, distance in pairs(links) do
      print("Got node " .. id .. " with distance " .. distance)
    end
<


LOAD                                                  *org-roam-database-load*

roam.database:load({opts})

Description:

Loads the database from disk and re-parses files. Returns a promise that
receives a database reference and collection of files.

Parameters:

- {opts} optional table.
    - force: optional, boolean or "scan". if true, will reload each file and
        node regardless of whether they have changed on disk. If "scan",
        will check for new or removed files. If false, only reloads
        pre-existing files and nodes if they have changed.

Example:

>lua
    local roam = require("org-roam")
    roam.database:load({ force = true }):next(function(results)
      ---@type OrgFiles
      local files = results.files
    end)
<


LOAD FILE                                        *org-roam-database-load-file*

roam.database:load_file({opts})

Description:

Loads the database from disk and re-parses files. Returns a promise that
receives an org file and list of roam nodes.

Parameters:

- {opts} required table.
    - path: required, string representing the path to the file.
    - force: optional, if true, will reload each file and node regardless of
        whether they have changed on disk. If false, only reloads
        pre-existing files and nodes if they have changed.

Example:

>lua
    local roam = require("org-roam")
    roam.database:load_file({ path = "path/to/file.org" }):next(function(results)
      ---@type OrgFile
      local file = results.file
    
      ---@type org-roam.core.file.Node[]
      local node = results.nodes
    end)
<


PATH                                                  *org-roam-database-path*

roam.database:path()

Description:

Returns the path to the database on disk.

Example:

>lua
    local roam = require("org-roam")
    roam.database:path()
<


SAVE                                                  *org-roam-database-save*

roam.database:save({opts})

Description:

Saves the database to disk. Returns a promise of nil.

Parameters:

- {opts} optional table.
    - force: optional, if true, will reload each file and node regardless of
        whether they have changed on disk. If false, only reloads
        pre-existing files and nodes if they have changed.

Example:

>lua
    local roam = require("org-roam")
    roam.database:save():next(function()
      print("Done!")
    end)
<


==============================================================================
8. Events                                                    *org-roam-events*


ON CURSOR NODE CHANGED                *org-roam-events-on-cursor-node-changed*

roam.events.on_cursornodechanged({cb})

Description:

Register a callback when a cursor move results in the node under the cursor
changing. This will also be triggered when the cursor moves to a position where
there is no node.

Parameters:

- {cb} triggered when the cursor moves to a different node or no node.
    Takes the node as an argument, or nil if no node.

Example:

>lua
    local roam = require("org-roam")
    roam.events.on_cursor_node_changed(function(node)
      if node then
        print("Node under cursor is " .. node.id)
      end
    end)
<


==============================================================================
9. Extensions                                            *org-roam-extensions*


DAILIES                                          *org-roam-extensions-dailies*

Unimplemented for now!


EXPORT                                            *org-roam-extensions-export*

Unimplemented for now!


GRAPH                                              *org-roam-extensions-graph*

Unimplemented for now!


PROTOCOL                                        *org-roam-extensions-protocol*

Unimplemented for now!


==============================================================================
10. Changelog                                             *org-roam-changelog*

TODO


==============================================================================
11. Credits                                                 *org-roam-credits*

- Kristijan Husak <https://github.com/kristijanhusak> for creating nvim-orgmode <https://github.com/nvim-orgmode/orgmode> (the backbone of functionality in neovim that we leverage)
- Jethro Kuan <https://github.com/jethrokuan> for creating Org Roam (Emacs) <https://github.com/org-roam/org-roam> (the original implementation whose design we copied)
- Daniel Mendler <https://github.com/minad> for creating vertico.el <https://github.com/minad/vertico> (inspiration for our selection dialog)
- Srinesh Nisala <https://github.com/s1n7ax> for creating nvim-window-picker <https://github.com/s1n7ax/nvim-window-picker> (integrated directly for our window selection)
- Dheepak Krishnamurthy <https://github.com/kdheepak> for creating panvimdoc <https://github.com/kdheepak/panvimdoc> (used to create our vimdoc)

Generated by panvimdoc <https://github.com/kdheepak/panvimdoc>

vim:tw=78:ts=8:noet:ft=help:norl:
